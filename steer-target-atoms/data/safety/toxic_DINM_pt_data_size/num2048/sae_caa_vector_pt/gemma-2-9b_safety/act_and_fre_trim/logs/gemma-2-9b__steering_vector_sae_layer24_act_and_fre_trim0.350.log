Namespace(path_dir='/data2/xzwnlp/SaeEdit/ManipulateSAE/data/safety/toxic_DINM_train', sae_path='/data2/xzwnlp/gemma-scope-9b-pt-res/layer_24/width_16k/average_l0_114', data_name='num2048', model_name='gemma-2-9b', mode='safety', select_type='act_and_fre_trim', layers=[24], hook_module='resid_post', trim=[0.35])
##########layer[24]###########
##########layer24###########
no1-torch.norm(caa_vector): 65.52981567382812
type(sae_path)
<class 'str'>

/data2/xzwnlp/gemma-scope-9b-pt-res/layer_24/width_16k/average_l0_114
act_data.norm：37.69916915893555
Negative data:76430.1640625 

top 10:tensor([2048., 2048., 2048., 2048., 2048., 2048., 2048., 2048., 2048., 2048.],
       device='cuda:0')
Positive data:78260.0625 

top 10:torch.sort(pos_data, descending=True)[0][:10]
Activation data:37.69916915893555 

top 10:tensor([15.2173,  9.2854,  8.1049,  7.4742,  7.1436,  4.9453,  4.8364,  4.7929,
         4.6874,  4.5470], device='cuda:0')
mask: tensor(14377, device='cuda:0')
频率阈值: 0.10626992583274841
prune_mask: tensor(5755, device='cuda:0')
######### act and fre ########
阈值: 0.021641459316015244
act_top_mask: tensor(5735, device='cuda:0')
combined_mask: tensor(4468, device='cuda:0')
tensor(668.3511, device='cuda:0')
result_combined.shape torch.Size([3584])
result_combined: tensor([ 0.0777,  0.2455, -0.3415,  ...,  0.0120,  0.9151, -0.6030],
       grad_fn=<SqueezeBackward4>)
torch.norm(result_combined) tensor(41.5496, grad_fn=<LinalgVectorNormBackward0>)
########### only act ########
阈值: 0.021641459316015244
act_top_mask: tensor(5735, device='cuda:0')
result_act.shape: torch.Size([3584])
result_act: tensor([ 0.6576,  0.2708, -0.4769,  ...,  0.1836,  0.8357, -0.9425],
       grad_fn=<SqueezeBackward4>)
torch.norm(result_act): tensor(55.3783, grad_fn=<LinalgVectorNormBackward0>)
########### only fre ########
result_fre.shape: torch.Size([3584])
result_fre: tensor([ 0.0665,  0.2492, -0.3505,  ...,  0.0173,  0.9134, -0.6193],
       grad_fn=<SqueezeBackward4>)
torch.norm(result_fre): tensor(41.6828, grad_fn=<LinalgVectorNormBackward0>)
