Namespace(path_dir='/data2/xzwnlp/SaeEdit/ManipulateSAE/data/safety/toxic_DINM_train', sae_path='/data2/xzwnlp/gemma-scope-9b-pt-res/layer_24/width_16k/average_l0_114', data_name='num256', model_name='gemma-2-9b', mode='safety', select_type='act_and_fre_trim', layers=[24], hook_module='resid_post', trim=[0.35])
##########layer[24]###########
##########layer24###########
no1-torch.norm(caa_vector): 65.52981567382812
type(sae_path)
<class 'str'>

/data2/xzwnlp/gemma-scope-9b-pt-res/layer_24/width_16k/average_l0_114
act_data.norm：39.358619689941406
Negative data:9677.7890625 

top 10:tensor([256., 256., 256., 256., 256., 256., 256., 256., 256., 256.],
       device='cuda:0')
Positive data:9643.3798828125 

top 10:torch.sort(pos_data, descending=True)[0][:10]
Activation data:39.358619689941406 

top 10:tensor([15.7198,  9.6316,  8.5602,  7.7232,  7.6874,  5.1327,  5.0166,  4.7901,
         4.6951,  4.5704], device='cuda:0')
mask: tensor(13026, device='cuda:0')
频率阈值: 0.1139240488409996
prune_mask: tensor(5755, device='cuda:0')
######### act and fre ########
阈值: 0.023510223254561424
act_top_mask: tensor(5735, device='cuda:0')
combined_mask: tensor(4390, device='cuda:0')
tensor(673.3264, device='cuda:0')
result_combined.shape torch.Size([3584])
result_combined: tensor([ 0.1580,  0.3051, -0.4991,  ...,  0.1235,  0.8643, -0.7057],
       grad_fn=<SqueezeBackward4>)
torch.norm(result_combined) tensor(41.0580, grad_fn=<LinalgVectorNormBackward0>)
########### only act ########
阈值: 0.023510223254561424
act_top_mask: tensor(5735, device='cuda:0')
result_act.shape: torch.Size([3584])
result_act: tensor([ 0.6869,  0.3540, -0.5220,  ...,  0.1606,  0.9229, -0.8883],
       grad_fn=<SqueezeBackward4>)
torch.norm(result_act): tensor(57.6789, grad_fn=<LinalgVectorNormBackward0>)
########### only fre ########
result_fre.shape: torch.Size([3584])
result_fre: tensor([ 0.1527,  0.3055, -0.5104,  ...,  0.1283,  0.8562, -0.7238],
       grad_fn=<SqueezeBackward4>)
torch.norm(result_fre): tensor(41.1889, grad_fn=<LinalgVectorNormBackward0>)
