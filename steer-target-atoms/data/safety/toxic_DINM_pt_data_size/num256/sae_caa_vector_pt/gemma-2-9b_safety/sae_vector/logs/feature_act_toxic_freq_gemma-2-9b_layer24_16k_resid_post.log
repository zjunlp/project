WARNING:root:You tried to specify center_unembed=True for a model using logit softcap, but this can't be done! Softcapping is not invariant upon adding a constantSetting center_unembed=False instead.
Namespace(batch_size=1, select_type='act_toxic_freq', output_file='/data2/xzwnlp/SaeEdit/ManipulateSAE/data/safety/toxic_DINM_train/num256/sae_caa_vector/gemma-2-9b_safety/act_toxic_freq/feature_act_toxic_freq_gemma-2-9b_layer24_16k_resid_post.json', data_file='/data2/xzwnlp/SaeEdit/ManipulateSAE/data/safety/toxic_DINM_train/num256/train.csv', data_name='num256', model_name_or_path='/data2/xzwnlp/model/gemma-2-9b', sae_path='/data2/xzwnlp/gemma-scope-9b-pt-res/layer_24/width_16k/average_l0_114', mode='safety', model_name='gemma-2-9b', system_prompt='', input_format_way='custom', steering_vector_name='gemma-2-9b_sae_layer24_resid_post_16k_steering_vector.pt', AB=False)
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:07,  1.13s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:02<00:07,  1.19s/it]Loading checkpoint shards:  38%|███▊      | 3/8 [00:03<00:06,  1.24s/it]Loading checkpoint shards:  50%|█████     | 4/8 [00:05<00:05,  1.29s/it]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:06<00:03,  1.22s/it]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:07<00:02,  1.22s/it]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:08<00:01,  1.22s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:09<00:00,  1.04s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:09<00:00,  1.15s/it]
WARNING:root:With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
WARNING:root:You are not using LayerNorm, so the writing weights can't be centered! Skipping
Loaded pretrained model /data2/xzwnlp/model/gemma-2-9b into HookedTransformer
#########mode:safety#############
Map:   0%|          | 0/256 [00:00<?, ? examples/s]Map: 100%|██████████| 256/256 [00:00<00:00, 13597.69 examples/s]
Computing the activation selection for activation_selection_contrastive_for_toxic_freq
act for safety:   0%|          | 0/256 [00:00<?, ?it/s]act for safety:   0%|          | 1/256 [00:01<07:21,  1.73s/it]act for safety:   1%|          | 2/256 [00:02<04:13,  1.00it/s]act for safety:   1%|          | 3/256 [00:02<03:20,  1.26it/s]act for safety:   2%|▏         | 4/256 [00:03<02:50,  1.47it/s]act for safety:   2%|▏         | 5/256 [00:03<02:33,  1.64it/s]act for safety:   2%|▏         | 6/256 [00:04<02:22,  1.75it/s]act for safety:   3%|▎         | 7/256 [00:04<02:08,  1.94it/s]act for safety:   3%|▎         | 8/256 [00:04<01:53,  2.19it/s]act for safety:   4%|▎         | 9/256 [00:05<01:46,  2.32it/s]act for safety:   4%|▍         | 10/256 [00:06<02:05,  1.96it/s]act for safety:   4%|▍         | 11/256 [00:06<01:52,  2.18it/s]act for safety:   5%|▍         | 12/256 [00:06<01:48,  2.25it/s]act for safety:   5%|▌         | 13/256 [00:07<01:40,  2.42it/s]act for safety:   5%|▌         | 14/256 [00:07<01:34,  2.57it/s]act for safety:   6%|▌         | 15/256 [00:07<01:29,  2.70it/s]act for safety:   6%|▋         | 16/256 [00:08<01:25,  2.80it/s]act for safety:   7%|▋         | 17/256 [00:08<01:25,  2.81it/s]act for safety:   7%|▋         | 18/256 [00:08<01:22,  2.90it/s]act for safety:   7%|▋         | 19/256 [00:09<01:20,  2.96it/s]act for safety:   8%|▊         | 20/256 [00:09<01:21,  2.91it/s]act for safety:   8%|▊         | 21/256 [00:09<01:21,  2.89it/s]act for safety:   9%|▊         | 22/256 [00:10<01:19,  2.93it/s]act for safety:   9%|▉         | 23/256 [00:10<01:18,  2.96it/s]act for safety:   9%|▉         | 24/256 [00:10<01:19,  2.90it/s]act for safety:  10%|▉         | 25/256 [00:11<01:20,  2.89it/s]act for safety:  10%|█         | 26/256 [00:11<01:19,  2.89it/s]act for safety:  11%|█         | 27/256 [00:11<01:17,  2.94it/s]act for safety:  11%|█         | 28/256 [00:12<01:16,  3.00it/s]act for safety:  11%|█▏        | 29/256 [00:12<01:17,  2.93it/s]act for safety:  12%|█▏        | 30/256 [00:12<01:19,  2.83it/s]act for safety:  12%|█▏        | 31/256 [00:13<01:17,  2.90it/s]act for safety:  12%|█▎        | 32/256 [00:13<01:19,  2.83it/s]act for safety:  13%|█▎        | 33/256 [00:13<01:17,  2.87it/s]act for safety:  13%|█▎        | 34/256 [00:14<01:16,  2.89it/s]act for safety:  14%|█▎        | 35/256 [00:14<01:17,  2.86it/s]act for safety:  14%|█▍        | 36/256 [00:14<01:14,  2.95it/s]act for safety:  14%|█▍        | 37/256 [00:15<01:38,  2.22it/s]act for safety:  15%|█▍        | 38/256 [00:15<01:28,  2.47it/s]act for safety:  15%|█▌        | 39/256 [00:16<01:40,  2.15it/s]act for safety:  16%|█▌        | 40/256 [00:16<01:35,  2.26it/s]act for safety:  16%|█▌        | 41/256 [00:17<01:28,  2.43it/s]act for safety:  16%|█▋        | 42/256 [00:17<01:24,  2.53it/s]act for safety:  17%|█▋        | 43/256 [00:18<01:19,  2.67it/s]act for safety:  17%|█▋        | 44/256 [00:18<01:17,  2.73it/s]act for safety:  18%|█▊        | 45/256 [00:18<01:15,  2.79it/s]act for safety:  18%|█▊        | 46/256 [00:19<01:19,  2.66it/s]act for safety:  18%|█▊        | 47/256 [00:19<01:22,  2.54it/s]act for safety:  19%|█▉        | 48/256 [00:19<01:19,  2.62it/s]act for safety:  19%|█▉        | 49/256 [00:20<01:17,  2.67it/s]act for safety:  20%|█▉        | 50/256 [00:20<01:14,  2.78it/s]act for safety:  20%|█▉        | 51/256 [00:20<01:12,  2.82it/s]act for safety:  20%|██        | 52/256 [00:21<01:11,  2.87it/s]act for safety:  21%|██        | 53/256 [00:21<01:15,  2.68it/s]act for safety:  21%|██        | 54/256 [00:22<01:14,  2.72it/s]act for safety:  21%|██▏       | 55/256 [00:22<01:13,  2.75it/s]act for safety:  22%|██▏       | 56/256 [00:22<01:13,  2.73it/s]act for safety:  22%|██▏       | 57/256 [00:23<01:15,  2.65it/s]act for safety:  23%|██▎       | 58/256 [00:23<01:17,  2.56it/s]act for safety:  23%|██▎       | 59/256 [00:23<01:14,  2.63it/s]act for safety:  23%|██▎       | 60/256 [00:24<01:12,  2.70it/s]act for safety:  24%|██▍       | 61/256 [00:24<01:15,  2.59it/s]act for safety:  24%|██▍       | 62/256 [00:25<01:18,  2.49it/s]act for safety:  25%|██▍       | 63/256 [00:25<01:15,  2.54it/s]act for safety:  25%|██▌       | 64/256 [00:25<01:14,  2.59it/s]act for safety:  25%|██▌       | 65/256 [00:26<01:16,  2.49it/s]act for safety:  26%|██▌       | 66/256 [00:26<01:15,  2.52it/s]act for safety:  26%|██▌       | 67/256 [00:27<01:13,  2.57it/s]act for safety:  27%|██▋       | 68/256 [00:27<01:12,  2.61it/s]act for safety:  27%|██▋       | 69/256 [00:27<01:14,  2.51it/s]act for safety:  27%|██▋       | 70/256 [00:28<01:12,  2.56it/s]act for safety:  28%|██▊       | 71/256 [00:28<01:15,  2.46it/s]act for safety:  28%|██▊       | 72/256 [00:29<01:18,  2.35it/s]act for safety:  29%|██▊       | 73/256 [00:29<01:20,  2.28it/s]act for safety:  29%|██▉       | 74/256 [00:30<01:23,  2.18it/s]act for safety:  29%|██▉       | 75/256 [00:30<01:26,  2.09it/s]act for safety:  30%|██▉       | 76/256 [00:31<01:42,  1.76it/s]act for safety:  30%|███       | 77/256 [00:31<01:33,  1.91it/s]act for safety:  30%|███       | 78/256 [00:32<01:24,  2.12it/s]act for safety:  31%|███       | 79/256 [00:32<01:21,  2.17it/s]act for safety:  31%|███▏      | 80/256 [00:33<01:18,  2.24it/s]act for safety:  32%|███▏      | 81/256 [00:33<01:12,  2.42it/s]act for safety:  32%|███▏      | 82/256 [00:33<01:08,  2.55it/s]act for safety:  32%|███▏      | 83/256 [00:34<01:08,  2.51it/s]act for safety:  33%|███▎      | 84/256 [00:34<01:07,  2.55it/s]act for safety:  33%|███▎      | 85/256 [00:34<01:06,  2.57it/s]act for safety:  34%|███▎      | 86/256 [00:35<01:04,  2.62it/s]act for safety:  34%|███▍      | 87/256 [00:35<01:04,  2.62it/s]act for safety:  34%|███▍      | 88/256 [00:36<01:03,  2.65it/s]act for safety:  35%|███▍      | 89/256 [00:36<01:03,  2.65it/s]act for safety:  35%|███▌      | 90/256 [00:36<01:02,  2.65it/s]act for safety:  36%|███▌      | 91/256 [00:37<01:02,  2.65it/s]act for safety:  36%|███▌      | 92/256 [00:37<01:05,  2.52it/s]act for safety:  36%|███▋      | 93/256 [00:37<01:03,  2.59it/s]act for safety:  37%|███▋      | 94/256 [00:38<01:04,  2.50it/s]act for safety:  37%|███▋      | 95/256 [00:38<01:07,  2.38it/s]act for safety:  38%|███▊      | 96/256 [00:39<01:03,  2.52it/s]act for safety:  38%|███▊      | 97/256 [00:39<01:01,  2.57it/s]act for safety:  38%|███▊      | 98/256 [00:39<00:59,  2.64it/s]act for safety:  39%|███▊      | 99/256 [00:40<01:02,  2.53it/s]act for safety:  39%|███▉      | 100/256 [00:40<01:00,  2.56it/s]act for safety:  39%|███▉      | 101/256 [00:41<00:58,  2.65it/s]act for safety:  40%|███▉      | 102/256 [00:41<00:56,  2.72it/s]act for safety:  40%|████      | 103/256 [00:41<00:56,  2.71it/s]act for safety:  41%|████      | 104/256 [00:42<01:01,  2.47it/s]act for safety:  41%|████      | 105/256 [00:42<00:58,  2.58it/s]act for safety:  41%|████▏     | 106/256 [00:43<00:57,  2.61it/s]act for safety:  42%|████▏     | 107/256 [00:43<00:55,  2.71it/s]act for safety:  42%|████▏     | 108/256 [00:43<00:55,  2.68it/s]act for safety:  43%|████▎     | 109/256 [00:44<00:53,  2.75it/s]act for safety:  43%|████▎     | 110/256 [00:44<00:52,  2.80it/s]act for safety:  43%|████▎     | 111/256 [00:44<00:53,  2.71it/s]act for safety:  44%|████▍     | 112/256 [00:45<00:51,  2.77it/s]act for safety:  44%|████▍     | 113/256 [00:45<00:49,  2.86it/s]act for safety:  45%|████▍     | 114/256 [00:45<00:52,  2.73it/s]act for safety:  45%|████▍     | 115/256 [00:46<00:52,  2.67it/s]act for safety:  45%|████▌     | 116/256 [00:46<00:57,  2.44it/s]act for safety:  46%|████▌     | 117/256 [00:47<00:55,  2.52it/s]act for safety:  46%|████▌     | 118/256 [00:47<00:52,  2.61it/s]act for safety:  46%|████▋     | 119/256 [00:47<00:51,  2.64it/s]act for safety:  47%|████▋     | 120/256 [00:48<00:51,  2.62it/s]act for safety:  47%|████▋     | 121/256 [00:48<00:49,  2.70it/s]act for safety:  48%|████▊     | 122/256 [00:48<00:48,  2.77it/s]act for safety:  48%|████▊     | 123/256 [00:49<00:47,  2.81it/s]act for safety:  48%|████▊     | 124/256 [00:49<00:47,  2.77it/s]act for safety:  49%|████▉     | 125/256 [00:50<00:46,  2.81it/s]act for safety:  49%|████▉     | 126/256 [00:50<00:45,  2.87it/s]act for safety:  50%|████▉     | 127/256 [00:50<00:44,  2.89it/s]act for safety:  50%|█████     | 128/256 [00:51<00:48,  2.64it/s]act for safety:  50%|█████     | 129/256 [00:51<00:50,  2.49it/s]act for safety:  51%|█████     | 130/256 [00:52<00:52,  2.40it/s]act for safety:  51%|█████     | 131/256 [00:52<00:48,  2.58it/s]act for safety:  52%|█████▏    | 132/256 [00:52<00:45,  2.72it/s]act for safety:  52%|█████▏    | 133/256 [00:52<00:42,  2.89it/s]act for safety:  52%|█████▏    | 134/256 [00:53<00:43,  2.82it/s]act for safety:  53%|█████▎    | 135/256 [00:53<00:41,  2.88it/s]act for safety:  53%|█████▎    | 136/256 [00:54<00:43,  2.76it/s]act for safety:  54%|█████▎    | 137/256 [00:54<00:41,  2.86it/s]act for safety:  54%|█████▍    | 138/256 [00:54<00:40,  2.93it/s]act for safety:  54%|█████▍    | 139/256 [00:55<00:38,  3.00it/s]act for safety:  55%|█████▍    | 140/256 [00:55<00:37,  3.07it/s]act for safety:  55%|█████▌    | 141/256 [00:55<00:37,  3.07it/s]act for safety:  55%|█████▌    | 142/256 [00:55<00:37,  3.08it/s]act for safety:  56%|█████▌    | 143/256 [00:56<00:36,  3.12it/s]act for safety:  56%|█████▋    | 144/256 [00:56<00:35,  3.16it/s]act for safety:  57%|█████▋    | 145/256 [00:56<00:34,  3.18it/s]act for safety:  57%|█████▋    | 146/256 [00:57<00:35,  3.13it/s]act for safety:  57%|█████▋    | 147/256 [00:57<00:35,  3.07it/s]act for safety:  58%|█████▊    | 148/256 [00:57<00:34,  3.13it/s]act for safety:  58%|█████▊    | 149/256 [00:58<00:34,  3.09it/s]act for safety:  59%|█████▊    | 150/256 [00:58<00:33,  3.13it/s]act for safety:  59%|█████▉    | 151/256 [00:58<00:34,  3.06it/s]act for safety:  59%|█████▉    | 152/256 [00:59<00:33,  3.10it/s]act for safety:  60%|█████▉    | 153/256 [00:59<00:32,  3.13it/s]act for safety:  60%|██████    | 154/256 [00:59<00:34,  2.93it/s]act for safety:  61%|██████    | 155/256 [01:00<00:33,  3.00it/s]act for safety:  61%|██████    | 156/256 [01:00<00:33,  2.97it/s]act for safety:  61%|██████▏   | 157/256 [01:01<00:39,  2.50it/s]act for safety:  62%|██████▏   | 158/256 [01:01<00:36,  2.68it/s]act for safety:  62%|██████▏   | 159/256 [01:01<00:35,  2.77it/s]act for safety:  62%|██████▎   | 160/256 [01:02<00:36,  2.61it/s]act for safety:  63%|██████▎   | 161/256 [01:02<00:36,  2.59it/s]act for safety:  63%|██████▎   | 162/256 [01:02<00:33,  2.77it/s]act for safety:  64%|██████▎   | 163/256 [01:03<00:35,  2.64it/s]act for safety:  64%|██████▍   | 164/256 [01:03<00:33,  2.72it/s]act for safety:  64%|██████▍   | 165/256 [01:03<00:32,  2.80it/s]act for safety:  65%|██████▍   | 166/256 [01:04<00:30,  2.93it/s]act for safety:  65%|██████▌   | 167/256 [01:04<00:29,  3.02it/s]act for safety:  66%|██████▌   | 168/256 [01:04<00:28,  3.07it/s]act for safety:  66%|██████▌   | 169/256 [01:05<00:27,  3.14it/s]act for safety:  66%|██████▋   | 170/256 [01:05<00:27,  3.12it/s]act for safety:  67%|██████▋   | 171/256 [01:05<00:29,  2.88it/s]act for safety:  67%|██████▋   | 172/256 [01:06<00:29,  2.89it/s]act for safety:  68%|██████▊   | 173/256 [01:06<00:28,  2.87it/s]act for safety:  68%|██████▊   | 174/256 [01:06<00:29,  2.82it/s]act for safety:  68%|██████▊   | 175/256 [01:07<00:27,  2.91it/s]act for safety:  69%|██████▉   | 176/256 [01:07<00:27,  2.88it/s]act for safety:  69%|██████▉   | 177/256 [01:08<00:26,  2.93it/s]act for safety:  70%|██████▉   | 178/256 [01:08<00:26,  2.94it/s]act for safety:  70%|██████▉   | 179/256 [01:08<00:25,  2.97it/s]act for safety:  70%|███████   | 180/256 [01:08<00:25,  3.02it/s]act for safety:  71%|███████   | 181/256 [01:09<00:24,  3.05it/s]act for safety:  71%|███████   | 182/256 [01:09<00:25,  2.94it/s]act for safety:  71%|███████▏  | 183/256 [01:09<00:23,  3.06it/s]act for safety:  72%|███████▏  | 184/256 [01:10<00:23,  3.05it/s]act for safety:  72%|███████▏  | 185/256 [01:10<00:23,  3.04it/s]act for safety:  73%|███████▎  | 186/256 [01:10<00:23,  2.95it/s]act for safety:  73%|███████▎  | 187/256 [01:11<00:23,  2.93it/s]act for safety:  73%|███████▎  | 188/256 [01:11<00:23,  2.92it/s]act for safety:  74%|███████▍  | 189/256 [01:12<00:23,  2.90it/s]act for safety:  74%|███████▍  | 190/256 [01:12<00:22,  2.94it/s]act for safety:  75%|███████▍  | 191/256 [01:12<00:21,  2.97it/s]act for safety:  75%|███████▌  | 192/256 [01:13<00:21,  2.95it/s]act for safety:  75%|███████▌  | 193/256 [01:13<00:21,  2.98it/s]act for safety:  76%|███████▌  | 194/256 [01:13<00:21,  2.84it/s]act for safety:  76%|███████▌  | 195/256 [01:14<00:21,  2.89it/s]act for safety:  77%|███████▋  | 196/256 [01:14<00:20,  2.89it/s]act for safety:  77%|███████▋  | 197/256 [01:14<00:20,  2.93it/s]act for safety:  77%|███████▋  | 198/256 [01:15<00:19,  2.96it/s]act for safety:  78%|███████▊  | 199/256 [01:15<00:19,  2.98it/s]act for safety:  78%|███████▊  | 200/256 [01:15<00:20,  2.77it/s]act for safety:  79%|███████▊  | 201/256 [01:16<00:19,  2.82it/s]act for safety:  79%|███████▉  | 202/256 [01:16<00:18,  2.86it/s]act for safety:  79%|███████▉  | 203/256 [01:16<00:18,  2.93it/s]act for safety:  80%|███████▉  | 204/256 [01:17<00:17,  3.02it/s]act for safety:  80%|████████  | 205/256 [01:17<00:16,  3.09it/s]act for safety:  80%|████████  | 206/256 [01:17<00:16,  3.09it/s]act for safety:  81%|████████  | 207/256 [01:18<00:16,  2.90it/s]act for safety:  81%|████████▏ | 208/256 [01:18<00:17,  2.82it/s]act for safety:  82%|████████▏ | 209/256 [01:18<00:16,  2.78it/s]act for safety:  82%|████████▏ | 210/256 [01:19<00:16,  2.80it/s]act for safety:  82%|████████▏ | 211/256 [01:19<00:17,  2.60it/s]act for safety:  83%|████████▎ | 212/256 [01:20<00:17,  2.55it/s]act for safety:  83%|████████▎ | 213/256 [01:20<00:17,  2.42it/s]act for safety:  84%|████████▎ | 214/256 [01:21<00:17,  2.39it/s]act for safety:  84%|████████▍ | 215/256 [01:21<00:16,  2.53it/s]act for safety:  84%|████████▍ | 216/256 [01:21<00:14,  2.70it/s]act for safety:  85%|████████▍ | 217/256 [01:22<00:14,  2.77it/s]act for safety:  85%|████████▌ | 218/256 [01:22<00:14,  2.70it/s]act for safety:  86%|████████▌ | 219/256 [01:22<00:13,  2.71it/s]act for safety:  86%|████████▌ | 220/256 [01:23<00:13,  2.64it/s]act for safety:  86%|████████▋ | 221/256 [01:23<00:12,  2.71it/s]act for safety:  87%|████████▋ | 222/256 [01:23<00:12,  2.81it/s]act for safety:  87%|████████▋ | 223/256 [01:24<00:11,  2.89it/s]act for safety:  88%|████████▊ | 224/256 [01:24<00:10,  2.93it/s]act for safety:  88%|████████▊ | 225/256 [01:24<00:10,  2.94it/s]act for safety:  88%|████████▊ | 226/256 [01:25<00:10,  2.92it/s]act for safety:  89%|████████▊ | 227/256 [01:25<00:12,  2.40it/s]act for safety:  89%|████████▉ | 228/256 [01:26<00:11,  2.45it/s]act for safety:  89%|████████▉ | 229/256 [01:26<00:10,  2.59it/s]act for safety:  90%|████████▉ | 230/256 [01:26<00:09,  2.76it/s]act for safety:  90%|█████████ | 231/256 [01:27<00:08,  2.78it/s]act for safety:  91%|█████████ | 232/256 [01:27<00:08,  2.93it/s]act for safety:  91%|█████████ | 233/256 [01:27<00:07,  2.92it/s]act for safety:  91%|█████████▏| 234/256 [01:28<00:07,  2.94it/s]act for safety:  92%|█████████▏| 235/256 [01:28<00:07,  2.93it/s]act for safety:  92%|█████████▏| 236/256 [01:28<00:06,  2.91it/s]act for safety:  93%|█████████▎| 237/256 [01:29<00:07,  2.53it/s]act for safety:  93%|█████████▎| 238/256 [01:29<00:07,  2.37it/s]act for safety:  93%|█████████▎| 239/256 [01:30<00:07,  2.32it/s]act for safety:  94%|█████████▍| 240/256 [01:30<00:07,  2.28it/s]act for safety:  94%|█████████▍| 241/256 [01:31<00:06,  2.27it/s]act for safety:  95%|█████████▍| 242/256 [01:31<00:06,  2.21it/s]act for safety:  95%|█████████▍| 243/256 [01:32<00:05,  2.19it/s]act for safety:  95%|█████████▌| 244/256 [01:32<00:05,  2.31it/s]act for safety:  96%|█████████▌| 245/256 [01:32<00:04,  2.47it/s]act for safety:  96%|█████████▌| 246/256 [01:33<00:03,  2.69it/s]act for safety:  96%|█████████▋| 247/256 [01:33<00:03,  2.84it/s]act for safety:  97%|█████████▋| 248/256 [01:33<00:02,  2.74it/s]act for safety:  97%|█████████▋| 249/256 [01:34<00:02,  2.80it/s]act for safety:  98%|█████████▊| 250/256 [01:34<00:02,  2.98it/s]act for safety:  98%|█████████▊| 251/256 [01:34<00:01,  3.08it/s]act for safety:  98%|█████████▊| 252/256 [01:35<00:01,  3.06it/s]act for safety:  99%|█████████▉| 253/256 [01:35<00:00,  3.10it/s]act for safety:  99%|█████████▉| 254/256 [01:35<00:00,  3.18it/s]act for safety: 100%|█████████▉| 255/256 [01:36<00:00,  2.96it/s]act for safety: 100%|██████████| 256/256 [01:36<00:00,  2.76it/s]act for safety: 100%|██████████| 256/256 [01:36<00:00,  2.65it/s]
torch.Size([16384])
tensor([ 0., 47.,  0.,  ...,  4., 82., 35.], device='cuda:0')
torch.Size([16384])
tensor([ 0., 82.,  0.,  ..., 23., 62., 54.], device='cuda:0')
torch.Size([16384])
tensor([0.0000, 0.0241, 0.0000,  ..., 0.0020, 0.0587, 0.0180], device='cuda:0')
torch.Size([16384])
tensor([0.0000, 0.0438, 0.0000,  ..., 0.0106, 0.0243, 0.0274], device='cuda:0')
steering_vector.shape: torch.Size([3584])
steering_vector: tensor([ 0.6862,  0.3569, -0.5732,  ...,  0.1584,  0.9063, -0.9105],
       device='cuda:0', grad_fn=<SqueezeBackward4>)
steering_vector.norm: tensor(57.9246, device='cuda:0', grad_fn=<LinalgVectorNormBackward0>)
feature_attr.shape: torch.Size([16384])
pos_feature_freq.shape: torch.Size([16384])
neg_feature_freq.shape: torch.Size([16384])
pos_act_mean.shape: torch.Size([16384])
neg_act_mean.shape: torch.Size([16384])
