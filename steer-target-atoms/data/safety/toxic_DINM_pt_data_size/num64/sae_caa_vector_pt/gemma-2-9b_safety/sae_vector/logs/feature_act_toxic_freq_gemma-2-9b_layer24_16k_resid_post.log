WARNING:root:You tried to specify center_unembed=True for a model using logit softcap, but this can't be done! Softcapping is not invariant upon adding a constantSetting center_unembed=False instead.
Namespace(batch_size=1, select_type='act_toxic_freq', output_file='/data2/xzwnlp/SaeEdit/ManipulateSAE/data/safety/toxic_DINM_train/num64/sae_caa_vector/gemma-2-9b/act_toxic_freq/feature_act_toxic_freq_gemma-2-9b_layer24_16k_resid_post.json', data_file='/data2/xzwnlp/SaeEdit/ManipulateSAE/data/safety/toxic_DINM_train/num64/train.csv', data_name='num64', model_name_or_path='/data2/xzwnlp/model/gemma-2-9b', sae_path='/data2/xzwnlp/gemma-scope-9b-pt-res/layer_24/width_16k/average_l0_114', mode='safety', model_name='gemma-2-9b', system_prompt='', input_format_way='custom', steering_vector_name='gemma-2-9b_sae_layer24_resid_post_16k_steering_vector.pt', AB=False)
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:00<00:06,  1.15it/s]Loading checkpoint shards:  25%|██▌       | 2/8 [00:01<00:04,  1.21it/s]Loading checkpoint shards:  38%|███▊      | 3/8 [00:02<00:03,  1.25it/s]Loading checkpoint shards:  50%|█████     | 4/8 [00:03<00:03,  1.24it/s]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:03<00:02,  1.28it/s]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:04<00:01,  1.31it/s]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:05<00:00,  1.34it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.48it/s]Loading checkpoint shards: 100%|██████████| 8/8 [00:05<00:00,  1.35it/s]
WARNING:root:With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
WARNING:root:You are not using LayerNorm, so the writing weights can't be centered! Skipping
Loaded pretrained model /data2/xzwnlp/model/gemma-2-9b into HookedTransformer
#########mode:safety#############
Map:   0%|          | 0/64 [00:00<?, ? examples/s]Map: 100%|██████████| 64/64 [00:00<00:00, 4733.14 examples/s]
Computing the activation selection for activation_selection_contrastive_for_toxic_freq
act for safety:   0%|          | 0/64 [00:00<?, ?it/s]act for safety:   2%|▏         | 1/64 [00:01<01:10,  1.11s/it]act for safety:   3%|▎         | 2/64 [00:01<00:48,  1.29it/s]act for safety:   5%|▍         | 3/64 [00:02<00:36,  1.69it/s]act for safety:   6%|▋         | 4/64 [00:02<00:30,  2.00it/s]act for safety:   8%|▊         | 5/64 [00:02<00:27,  2.16it/s]act for safety:   9%|▉         | 6/64 [00:03<00:27,  2.07it/s]act for safety:  11%|█         | 7/64 [00:04<00:32,  1.74it/s]act for safety:  12%|█▎        | 8/64 [00:04<00:29,  1.92it/s]act for safety:  14%|█▍        | 9/64 [00:04<00:25,  2.20it/s]act for safety:  16%|█▌        | 10/64 [00:05<00:22,  2.44it/s]act for safety:  17%|█▋        | 11/64 [00:05<00:20,  2.62it/s]act for safety:  19%|█▉        | 12/64 [00:05<00:18,  2.75it/s]act for safety:  20%|██        | 13/64 [00:06<00:17,  2.85it/s]act for safety:  22%|██▏       | 14/64 [00:06<00:17,  2.82it/s]act for safety:  23%|██▎       | 15/64 [00:06<00:17,  2.82it/s]act for safety:  25%|██▌       | 16/64 [00:07<00:17,  2.67it/s]act for safety:  27%|██▋       | 17/64 [00:07<00:18,  2.59it/s]act for safety:  28%|██▊       | 18/64 [00:08<00:17,  2.58it/s]act for safety:  30%|██▉       | 19/64 [00:08<00:17,  2.59it/s]act for safety:  31%|███▏      | 20/64 [00:08<00:16,  2.63it/s]act for safety:  33%|███▎      | 21/64 [00:09<00:16,  2.67it/s]act for safety:  34%|███▍      | 22/64 [00:09<00:15,  2.66it/s]act for safety:  36%|███▌      | 23/64 [00:09<00:15,  2.67it/s]act for safety:  38%|███▊      | 24/64 [00:10<00:15,  2.59it/s]act for safety:  39%|███▉      | 25/64 [00:10<00:14,  2.64it/s]act for safety:  41%|████      | 26/64 [00:11<00:14,  2.61it/s]act for safety:  42%|████▏     | 27/64 [00:11<00:13,  2.74it/s]act for safety:  44%|████▍     | 28/64 [00:11<00:12,  2.86it/s]act for safety:  45%|████▌     | 29/64 [00:11<00:11,  2.96it/s]act for safety:  47%|████▋     | 30/64 [00:12<00:11,  2.95it/s]act for safety:  48%|████▊     | 31/64 [00:12<00:12,  2.74it/s]act for safety:  50%|█████     | 32/64 [00:13<00:11,  2.89it/s]act for safety:  52%|█████▏    | 33/64 [00:13<00:10,  3.01it/s]act for safety:  53%|█████▎    | 34/64 [00:13<00:09,  3.07it/s]act for safety:  55%|█████▍    | 35/64 [00:13<00:09,  3.11it/s]act for safety:  56%|█████▋    | 36/64 [00:14<00:09,  2.94it/s]act for safety:  58%|█████▊    | 37/64 [00:14<00:09,  2.83it/s]act for safety:  59%|█████▉    | 38/64 [00:15<00:08,  2.93it/s]act for safety:  61%|██████    | 39/64 [00:15<00:09,  2.76it/s]act for safety:  62%|██████▎   | 40/64 [00:15<00:08,  2.82it/s]act for safety:  64%|██████▍   | 41/64 [00:16<00:07,  2.95it/s]act for safety:  66%|██████▌   | 42/64 [00:16<00:07,  2.76it/s]act for safety:  67%|██████▋   | 43/64 [00:16<00:07,  2.65it/s]act for safety:  69%|██████▉   | 44/64 [00:17<00:07,  2.69it/s]act for safety:  70%|███████   | 45/64 [00:17<00:06,  2.74it/s]act for safety:  72%|███████▏  | 46/64 [00:17<00:06,  2.80it/s]act for safety:  73%|███████▎  | 47/64 [00:18<00:05,  2.83it/s]act for safety:  75%|███████▌  | 48/64 [00:18<00:05,  2.85it/s]act for safety:  77%|███████▋  | 49/64 [00:19<00:05,  2.73it/s]act for safety:  78%|███████▊  | 50/64 [00:19<00:04,  2.80it/s]act for safety:  80%|███████▉  | 51/64 [00:19<00:04,  2.62it/s]act for safety:  81%|████████▏ | 52/64 [00:20<00:04,  2.47it/s]act for safety:  83%|████████▎ | 53/64 [00:20<00:04,  2.65it/s]act for safety:  84%|████████▍ | 54/64 [00:20<00:03,  2.77it/s]act for safety:  86%|████████▌ | 55/64 [00:21<00:03,  2.64it/s]act for safety:  88%|████████▊ | 56/64 [00:21<00:02,  2.78it/s]act for safety:  89%|████████▉ | 57/64 [00:21<00:02,  2.87it/s]act for safety:  91%|█████████ | 58/64 [00:22<00:02,  2.88it/s]act for safety:  92%|█████████▏| 59/64 [00:22<00:01,  2.95it/s]act for safety:  94%|█████████▍| 60/64 [00:23<00:01,  2.90it/s]act for safety:  95%|█████████▌| 61/64 [00:23<00:00,  3.01it/s]act for safety:  97%|█████████▋| 62/64 [00:23<00:00,  3.02it/s]act for safety:  98%|█████████▊| 63/64 [00:23<00:00,  3.10it/s]act for safety: 100%|██████████| 64/64 [00:24<00:00,  3.10it/s]act for safety: 100%|██████████| 64/64 [00:24<00:00,  2.64it/s]
torch.Size([16384])
tensor([ 0., 13.,  0.,  ...,  0., 18., 14.], device='cuda:0')
torch.Size([16384])
tensor([ 0., 18.,  0.,  ...,  6., 13., 13.], device='cuda:0')
torch.Size([16384])
tensor([0.0000, 0.0257, 0.0000,  ..., 0.0000, 0.0428, 0.0270], device='cuda:0')
torch.Size([16384])
tensor([0.0000, 0.0483, 0.0000,  ..., 0.0114, 0.0180, 0.0366], device='cuda:0')
steering_vector.shape: torch.Size([3584])
steering_vector: tensor([ 0.7833,  0.3296, -0.3486,  ...,  0.1396,  0.8709, -1.0080],
       device='cuda:0', grad_fn=<SqueezeBackward4>)
steering_vector.norm: tensor(59.9271, device='cuda:0', grad_fn=<LinalgVectorNormBackward0>)
feature_attr.shape: torch.Size([16384])
pos_feature_freq.shape: torch.Size([16384])
neg_feature_freq.shape: torch.Size([16384])
pos_act_mean.shape: torch.Size([16384])
neg_act_mean.shape: torch.Size([16384])
