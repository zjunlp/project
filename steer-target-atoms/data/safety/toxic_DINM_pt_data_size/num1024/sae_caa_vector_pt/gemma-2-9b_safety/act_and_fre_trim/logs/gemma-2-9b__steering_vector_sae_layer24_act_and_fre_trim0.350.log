Namespace(path_dir='/data2/xzwnlp/SaeEdit/ManipulateSAE/data/safety/toxic_DINM_train', sae_path='/data2/xzwnlp/gemma-scope-9b-pt-res/layer_24/width_16k/average_l0_114', data_name='num1024', model_name='gemma-2-9b', mode='safety', select_type='act_and_fre_trim', layers=[24], hook_module='resid_post', trim=[0.35])
##########layer[24]###########
##########layer24###########
no1-torch.norm(caa_vector): 65.52981567382812
type(sae_path)
<class 'str'>

/data2/xzwnlp/gemma-scope-9b-pt-res/layer_24/width_16k/average_l0_114
act_data.norm：38.34466552734375
Negative data:38260.53515625 

top 10:tensor([1024., 1024., 1024., 1024., 1024., 1024., 1024., 1024., 1024., 1024.],
       device='cuda:0')
Positive data:39044.12109375 

top 10:torch.sort(pos_data, descending=True)[0][:10]
Activation data:38.34466552734375 

top 10:tensor([15.3160,  9.4551,  8.2789,  7.5502,  7.1400,  5.0203,  4.9599,  4.9332,
         4.6695,  4.5946], device='cuda:0')
mask: tensor(14047, device='cuda:0')
频率阈值: 0.1099252924323082
prune_mask: tensor(5781, device='cuda:0')
######### act and fre ########
阈值: 0.02225857600569725
act_top_mask: tensor(5735, device='cuda:0')
combined_mask: tensor(4485, device='cuda:0')
tensor(678.9172, device='cuda:0')
result_combined.shape torch.Size([3584])
result_combined: tensor([ 0.1174,  0.3142, -0.3931,  ..., -0.0118,  0.8705, -0.6694],
       grad_fn=<SqueezeBackward4>)
torch.norm(result_combined) tensor(41.9495, grad_fn=<LinalgVectorNormBackward0>)
########### only act ########
阈值: 0.02225857600569725
act_top_mask: tensor(5735, device='cuda:0')
result_act.shape: torch.Size([3584])
result_act: tensor([ 0.6910,  0.2967, -0.4831,  ...,  0.1743,  0.8617, -0.9570],
       grad_fn=<SqueezeBackward4>)
torch.norm(result_act): tensor(56.3983, grad_fn=<LinalgVectorNormBackward0>)
########### only fre ########
result_fre.shape: torch.Size([3584])
result_fre: tensor([ 0.1058,  0.3183, -0.3965,  ..., -0.0153,  0.8697, -0.6922],
       grad_fn=<SqueezeBackward4>)
torch.norm(result_fre): tensor(42.0847, grad_fn=<LinalgVectorNormBackward0>)
