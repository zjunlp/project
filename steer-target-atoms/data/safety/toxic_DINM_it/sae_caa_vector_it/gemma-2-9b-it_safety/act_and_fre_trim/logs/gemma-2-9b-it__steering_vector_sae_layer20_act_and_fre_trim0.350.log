Namespace(path_dir='/data2/xzwnlp/SaeEdit/ManipulateSAE/data/safety', sae_path='/disk3/wmr/hugging_cache/gemma-scope-9b-it-res/layer_20/width_16k/average_l0_91', data_name='toxic_DINM_it', model_name='gemma-2-9b-it', mode='safety', select_type='act_and_fre_trim', layers=[20], hook_module='resid_post', trim=[0.35], re_error_way=False)
re_error_way: False
##########layer20###########
##########layer20###########
no1-torch.norm(caa_vector): 70.65082550048828
type(sae_path)
<class 'str'>

/disk3/wmr/hugging_cache/gemma-scope-9b-it-res/layer_20/width_16k/average_l0_91
act_data.norm：38.160865783691406
re_error: 58.00600051879883

top 10:tensor([18.4931,  5.5265,  4.8170,  4.4031,  4.0664,  3.6070,  3.5400,  3.1698,
         2.7154,  2.6844], grad_fn=<SliceBackward0>)
Negative data:131615.515625 

top 10:tensor([4050., 4050., 4050., 4050., 4050., 4049., 4048., 4048., 4048., 4048.],
       device='cuda:0')
Positive data:132361.171875 

top 10:tensor([4050., 4050., 4050., 4050., 4050., 4050., 4050., 4050., 4050., 4050.],
       device='cuda:0')
Activation data:38.160865783691406 

top 10:tensor([16.0996, 15.8225,  7.1592,  5.7709,  5.7354,  5.6483,  5.2240,  4.6626,
         4.5245,  4.3848], device='cuda:0')
mask: tensor(14763, device='cuda:0')
频率阈值: 0.08131982386112213
prune_mask: tensor(5740, device='cuda:0')
######### act and fre ########
阈值: 0.01873871497809887
act_top_mask: tensor(5735, device='cuda:0')
combined_mask: tensor(4606, device='cuda:0')
tensor(673.4144, device='cuda:0')
result_combined.shape torch.Size([3584])
result_combined: tensor([ 0.2027, -0.7075, -0.3120,  ...,  0.3241,  1.1017, -0.3636],
       grad_fn=<SqueezeBackward4>)
torch.norm(result_combined) tensor(41.7389, grad_fn=<LinalgVectorNormBackward0>)
########### only act ########
阈值: 0.01873871497809887
act_top_mask: tensor(5735, device='cuda:0')
result_act.shape: torch.Size([3584])
result_act: tensor([ 0.4511, -0.7345, -0.5626,  ...,  0.2390,  0.8050, -0.2345],
       grad_fn=<SqueezeBackward4>)
########### only fre ########
result_fre.shape: torch.Size([3584])
result_fre: tensor([ 0.1901, -0.7059, -0.3306,  ...,  0.3179,  1.1027, -0.3790],
       grad_fn=<SqueezeBackward4>)
